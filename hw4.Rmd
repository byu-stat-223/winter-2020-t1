---
title: "Homework 4"
date: "Due 2019-02-04 at 11:59pm"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

+ Follow [this link](https://classroom.github.com/a/Usr4ZeSC) to create your 
repository for homework 4.

+ Once your repository is created, create a new RStudio project based on that
repository.

## Exploring One-Way ANOVA Assumptions

+ One-way Analysis of Variance (ANOVA) tests the null hypothesis that the
means of K populations are equal versus the alternative hypothesis that they
are not all equal. The testing procedure makes the following assumptions
about the probability distributions of the responses:

+ Independence: Observations are independent of each other.
+ Normality: Observations are sampled from normally distributed populations.
+ Homoscedasticity: The variances in the K populations are equal.

+ In this homework assignment, you will explore the statistical properties of
one-way ANOVA, including situations in which the assumptions are violated. For
each simulation scenario described below, use 5,000 repetitions for your final
results. This may be computationally demanding (perhaps taking many minutes to
complete all the calculations), so it is recommended that you develop your code
using fewer repetitions. Write R code in a file `anova-simulation.R` (or
`anova-simulation.Rmd`) to answer the following and summarize your findings in a
file called `memo.txt`.

* Hint: If you have a data.frame `my_data` with variables `response` (giving 
the measurement) and `treatment` (giving the label for the population), you 
can perform one-way ANOVA with the following code: `fm <- lm(response ~ 
as.factor(treatment), data = my_data)`. Further, you can get the p-value for the
ANOVA test with the following code: `anova(fm)$"Pr(>F)"[1]`.

A. Write an R function named `anova_sim` whose only argument is a
list of `K` functions. Each function in the list takes no arguments and
returns a numeric vector representing a random sample from a population.
Each time a particular function is called, a new random sample is
returned. For example, the argument to the `anova_sim` function
might be `list(function() rnorm(10), function() rnorm(15), function()
runif(20,-sqrt(3),sqrt(3)))`, in which case we obtain random samples of
size 10, 15, and 20 from K=3 populations, the first two of which are
standard normally distributed and third of which is uniformly
distributed between '-sqrt(3)' and 'sqrt(3))'. Your `anova_sim`
function should return a list of two elements:

1. a numeric vector of length three giving a Monte Carlo estimate
and a 95% confidence interval for the probability of rejecting the
null hypothesis using the standard one-way ANOVA test with level of
significance alpha=0.05, and

2. a numeric vector of the p-values from every ANOVA test performed
in the Monte Carlo study.

B. Consider the following list of functions `list(function()
rnorm(10), function() rnorm(10), function() rnorm(10))` representing
sampling from three populations. Are all of the ANOVA assumption meet in
this case? Is the null hypothesis true or false in this setting? Using
output from your `anova_sim` function, show that distribution of
the p-value is uniformly distributed (up to Monte Carlo error) using a
histogram. What proportion of the p-values are less than or equal to
0.05?

C. Take the scenario in item B above, but now consider various sample
sizes n and suppose that the third population has random samples
generated by the pop3 function below.

```{r, eval=FALSE}
shape1 <- 0.05
shape2 <- 0.2
mean <- shape1/(shape1+shape2)
sd <- sqrt((shape1*shape2)/((shape1+shape2)^2*(shape1+shape2+1)))
pop3 <- function() (rbeta(n, shape1 = shape1, shape2 = shape2) - mean) / sd
```

In this case, the mean is 0 and the standard deviation is 1 for all
three populations. Which ANOVA assumptions are violated in this case? If
the p-value is less than 0.05, you will declare significance. That is,
the desired level of the test is 0.05, meaning that the Type I error
rate is desired to be 0.05. Compute the size of the testing procedure
(i.e., that actual Type I error rate) when the sample size in each
population is 2, 4, or 10. What do you notice as the sample size
increases?

+  **Make sure you commit your changes to git and push to GitHub**
